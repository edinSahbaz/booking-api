{
  "version": "2.1.3",
  "summary": {
    "title": "New Threat Model",
    "owner": "Edin Šahbaz",
    "description": "Booking API project implemented using Clean Architecture principles and ASP.NET Core.",
    "id": 0
  },
  "detail": {
    "contributors": [
      {
        "name": "Edin Šahbaz"
      }
    ],
    "diagrams": [
      {
        "id": 0,
        "title": "System overview",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.1.3",
        "cells": [
          {
            "position": {
              "x": 200,
              "y": 330
            },
            "size": {
              "width": 240,
              "height": 150
            },
            "attrs": {
              "text": {
                "text": "API"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 1,
            "id": "9671a668-c400-43a5-9616-2c5cc6e0f712",
            "data": {
              "type": "tm.Process",
              "name": "API",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "privilegeLevel": "",
              "hasOpenThreats": true,
              "threats": [
                {
                  "id": "f280ea03-1a26-4fca-8d89-56874bcdedec",
                  "title": "No Rate Limiting Implemented",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of service",
                  "description": "API has no Rate Limiting implemented, opening the possibility for a DoS attack.",
                  "mitigation": "Implement IP based rate limiting.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 6,
                  "score": ""
                }
              ]
            }
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "id": "edd734c9-b4e9-47e3-a4f8-d0f70188465f",
            "source": {
              "x": 30,
              "y": 270
            },
            "target": {
              "x": 350,
              "y": 120
            },
            "vertices": [
              {
                "x": 50,
                "y": 330
              },
              {
                "x": 150,
                "y": 330
              },
              {
                "x": 280,
                "y": 230
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Web request (HTTP)",
              "description": "",
              "outOfScope": false,
              "isBidirectional": false,
              "reasonOutOfScope": "",
              "protocol": "",
              "isEncrypted": false,
              "isPublicNetwork": false,
              "hasOpenThreats": true,
              "threats": [
                {
                  "id": "78b02e71-79ba-435e-9466-d3ff873fbea7",
                  "title": "Data flow should use HTTPS",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "These requests are made over the public internet and could be intercepted by an attacker.",
                  "mitigation": "The requests should require HTTPS. This will provide confidentiality and integrity. HTTP should not be supported.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 4,
                  "score": ""
                }
              ]
            },
            "id": "979cedda-3c33-4b0f-8d5a-e462b10d902d",
            "labels": [
              "Web request (HTTP)"
            ],
            "source": {
              "x": 270,
              "y": 90
            },
            "target": {
              "cell": "9671a668-c400-43a5-9616-2c5cc6e0f712"
            },
            "vertices": [
              {
                "x": 300,
                "y": 140
              },
              {
                "x": 300,
                "y": 240
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Web response (HTTP)",
              "description": "",
              "outOfScope": false,
              "isBidirectional": false,
              "reasonOutOfScope": "",
              "protocol": "",
              "isEncrypted": false,
              "isPublicNetwork": false,
              "hasOpenThreats": true,
              "threats": [
                {
                  "id": "90862e48-82bc-4c2e-bd7e-1738dcea211e",
                  "title": "Data flow should use HTTPS",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "These requests are made over the public internet and could be intercepted by an attacker.",
                  "mitigation": "The requests should require HTTPS. This will provide confidentiality and integrity. HTTP should not be supported.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 3,
                  "score": ""
                }
              ]
            },
            "id": "bb6df1fd-6447-4767-a36f-eabcdb0e0e52",
            "labels": [
              "Web response (HTTP)"
            ],
            "source": {
              "cell": "9671a668-c400-43a5-9616-2c5cc6e0f712"
            },
            "target": {
              "cell": "94022280-ecc7-4089-a864-afe5a492cb42"
            },
            "vertices": [
              {
                "x": 180,
                "y": 370
              },
              {
                "x": 130,
                "y": 270
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Queries",
              "description": "",
              "outOfScope": false,
              "isBidirectional": false,
              "reasonOutOfScope": "",
              "protocol": "",
              "isEncrypted": false,
              "isPublicNetwork": false,
              "hasOpenThreats": true,
              "threats": [
                {
                  "id": "ee799704-cdcf-4074-bb3e-8317ec901b1e",
                  "title": "Queries not sanitized",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Queries are not sanitized, meaning the SQL Injection can be performed.",
                  "mitigation": "User queries should be sanitized properly on the backend.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 5,
                  "score": ""
                }
              ]
            },
            "id": "a6519f39-047c-498d-9d24-6102cfc9885b",
            "labels": [
              "Queries"
            ],
            "source": {
              "cell": "9671a668-c400-43a5-9616-2c5cc6e0f712"
            },
            "target": {
              "x": 580,
              "y": 270
            },
            "vertices": [
              {
                "x": 560,
                "y": 440
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Query results",
              "description": "",
              "outOfScope": false,
              "isBidirectional": false,
              "reasonOutOfScope": "",
              "protocol": "",
              "isEncrypted": false,
              "isPublicNetwork": false,
              "hasOpenThreats": false,
              "threats": []
            },
            "id": "0ec1f533-af9d-4ad1-aeac-d526c6280a6e",
            "labels": [
              "Query results"
            ],
            "source": {
              "cell": "354822df-fd0e-4b90-b3c3-ddee66663ca5"
            },
            "target": {
              "cell": "9671a668-c400-43a5-9616-2c5cc6e0f712"
            }
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "id": "6ba094c3-5b73-4396-8611-cc6b453beb0c",
            "source": {
              "x": 420,
              "y": 160
            },
            "target": {
              "x": 720,
              "y": 360
            },
            "vertices": [
              {
                "x": 480,
                "y": 290
              }
            ]
          },
          {
            "position": {
              "x": 50,
              "y": 40
            },
            "size": {
              "width": 220,
              "height": 110
            },
            "attrs": {
              "text": {
                "text": "Browser"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 11,
            "id": "94022280-ecc7-4089-a864-afe5a492cb42",
            "data": {
              "type": "tm.Actor",
              "name": "Browser",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "providesAuthentication": false,
              "hasOpenThreats": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 490,
              "y": 160
            },
            "size": {
              "width": 280,
              "height": 110
            },
            "attrs": {
              "text": {
                "text": "Database"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 12,
            "id": "354822df-fd0e-4b90-b3c3-ddee66663ca5",
            "data": {
              "type": "tm.Store",
              "name": "Database",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "isALog": false,
              "storesCredentials": true,
              "isEncrypted": false,
              "isSigned": false,
              "hasOpenThreats": true,
              "threats": [
                {
                  "id": "626ee2e0-48bc-49ea-b6a1-f3e735513493",
                  "title": "Unauthorised access",
                  "status": "Mitigated",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "An attacker could make an query call on the DB,",
                  "mitigation": "Require all queries to be authenticated.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 1,
                  "score": ""
                },
                {
                  "id": "d009c00a-cc84-4e86-bbc0-7edbdfe4ae2a",
                  "title": "Credentials should be encrypted",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "The Web Application Config stores credentials used  by the Web App to access the message queue. These could be stolen by an attacker and used to read confidential data or place poison message on the queue.",
                  "mitigation": "The credentials in DB should be encrypted.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 2,
                  "score": ""
                }
              ]
            }
          }
        ],
        "description": "System overview"
      }
    ],
    "diagramTop": 1,
    "reviewer": "Edin Šahbaz",
    "threatTop": 6
  }
}